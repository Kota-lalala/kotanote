
<!DOCTYPE html>
<html lang="ja">
    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap4.3.1用 -->
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<!--        メイン用 style.css-->
        <link rel="stylesheet" type="text/css" href="css/style-wet.css">

<!--        FontAwesome用-->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        <title>今のお天気なあに ？</title>

    </head>
    <body>

        <!--   アラートでお知らせ-->
        <div class="alert alert-info alert-dismissible fade show" role="alert">
            <strong>musicページ追加しました。でも入室できるのはネズミとうさぎとうまととりのみ。各自5分づつだけです\(^O^)/</strong>
            <span id="alert-os"></span>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>



<!--       header-->
        <header>

            <!--            三角　左側-->
            <div class="triangle tri-up">
                <i class="fas fa-caret-up" id="caret-up"></i>
            </div>

            <div class="header-title">
                <h1 class="text-center mt-3">今のお天気なあに？</h1>
                <h5 class="text-center">ver 1.22</h5>
                <p class="text-center mt-2">今の天気の絵をクリックしてね ♪</p>
            </div>

            <!--            三角　右側-->
            <div class="triangle tri-down">
                <i class="fas fa-caret-down" id="caret-down"></i>
            </div>

        </header>


        <article>

<!--            今のお天気なあに？のセクション-->
            <section class="weather top-box">

               <!--        メインコンテンツ-->
               <div class=" weather-top-box d-flex flex-row">
                   <button type="button" id="weather-sunny">
                       <img id="weather-sunny-img" src="img/weather0-sunny.png" alt="晴れ">
                       <p id="sunny-count"></p>
                   </button>
                   <button type="button" id="weather-cloudy">
                       <img src="img/weather1-cloudy.png" alt="曇り">
                       <p id="cloudy-count"></p>
                   </button>
                   <button type="button" id="weather-rain">
                       <img src="img/weather2-rain.png" alt="雨">
                       <p id="rain-count"></p>
                   </button>
               </div>

           </section>

<!--            musicのセクション-->
            <section class="music music-note top-box">

            <!--            「ハルノヒ」〜あいみょん〜-->
                <div>
                    <div class="card h-100 cm-190323">
                        <div class="card-header mb-0">
                            <h2 style="text-align: center">「ハルノヒ」〜あいみょん〜</h2>
                        </div>
                        <div class="card-body">
                            <div class="awa-div">
                                <iframe src="https://embed.awa.fm/track/653bb7ab24d01a855f30/?t=1554380346" width="100%" height="354" frameborder="0" allowtransparency="true"></iframe>
                            </div>
                            <div class="card-link" style="text-align: center">
                                <a href="http://www.aimyong.net/">
                                    あいみょん<br>
                                    <span>http://www.aimyong.net/</span>
                                </a>
                            </div>
                            <div class="awa-come">
                                <p>
                                    君の強さと僕の弱さを分け合えば、一人じゃ無理でも出来るかも。
                                </p>
                                <!--            <p>更新日：2019.3.14</p>-->
                                <p>掲載日：2019.4.8</p>
                            </div>
                        </div>
                    </div>
                </div>

        </section>

<!--            pictureのセクション？-->
            <section class="pic">

            </section>

<!--            インフォメーション-->
            <section class="info">
                <!--        ツイッターのシェアボタン-->
                <div class="m-3">
                    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-text="「今のお天気なあに？」気軽にクリックしてくださいね。クリックしてくれると成長していきます！育ててやって下さい^0^" data-url="https://kotanote.com/kotanote/public/prog/weather/" data-via="kota_lalala" data-hashtags="codelife1st" data-related="manabubannai " data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                </div>

                <!--        このサイトについて・リリースノート-->
                <div class="accordion" id="accordionExample">
                    <div class="card">
                        <div class="card-header" id="headingOne">
                            <h2 class="mb-0 text-center">
                                <button class="btn" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" onfocus="this.blur();">
                                    このサイトについて
                                </button>
                            </h2>
                        </div>

                        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                            <div class="card-body">
                                訪問していただいたあなたの場所の今の天気をクリックしてください！みんなのクリック数でお天気絵の大きさが変わります。今後もバージョンアップしながら機能を増やしていきますので、またクリックしてもらえたら嬉しいです。
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header" id="headingTwo">
                            <h2 class="mb-0 text-center">
                                <button class="btn collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" onfocus="this.blur();">
                                    リリースノート
                                </button>
                            </h2>
                        </div>
                        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                            <div class="card-body">
                                <ul>
                                    <li>2019.4.10 alertを追加しました。(ver1.221)</li>
                                    <li>2019.4.9 時間によって色を変更する機能を追加しました。(ver1.22)</li>
                                    <li>2019.4.9 夜はお星様機能を追加しました。(ver1.21)</li>
                                    <li>2019.4.8 ページを追加しました！(でも入室できるのはネズミとうさぎとうまととりのみ。各自5分づつだけですよ^^(ver1.2)</li>
                                    <li>2019.4.7 カーソルが乗っている時に解り易い様、大きくなるようにしました。</li>
                                    <li>2019.4.7 差が大きすぎると0になり、いなくなってしまうので、最低値を1に修正</li>
                                    <li>2019.4.7 ツイッターのシェアボタンを追加。</li>
                                    <li>2019.4.7 kotanoteのフッターを追加。</li>
                                    <li>2019.4.7 リリースノートを追加。</li>
                                    <li>2019.4.6 before(全てのクリックの総数)after(今から1時間以内のクリック数)に絞りました。</li>
                                    <li>2019.4.5 「今のお天気なあに？ver1.0」公開開始しました！</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>

            </section>

        </article>



        <!--        footer-->
        <footer class="foot mt-3 text-center">
            <ul class="box2">
                <a href="../../info/info.html">
                    <li class="box3">
                        <p>Kotanoteについて</p>
                    </li>
                </a>
                <a href="mailto:kotanote2019@gmail.com">
                    <li class="box3">
                        <p>お問合せ</p>
                    </li>
                </a>
                <li class="box3">
                    <p>©︎ 2019 Kotanote.com</p>
                </li>
            </ul>
        </footer>

<!--
        <script type="text/javascript">
            $.ajax({
                success : function(response){
                    alert('成功');
                },
                error: function(){
                    //通信失敗時の処
                    alert('通信失敗');
                }
            });
        </script>
-->

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<!--        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->
<!--        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>-->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<!--        javascript-->
    <script type="text/javascript">

            if(nowTime()) {
                $('#caret-down').show();
            } else {
                $('#caret-down').hide();
            }

            changeImg();

            $('.music').hide();

    //            晴れ、曇り、雨のボタンがクリックされた時にファンクションを実行
            $('#weather-sunny').click(function(){
                weatherSave('晴れ');
            });
            $('#weather-cloudy').click(function(){
                weatherSave('曇り');
            });
            $('#weather-rain').click(function(){
                weatherSave('雨');
            });

    //            ajaxでphpにアクセスする
            function weatherSave(weatherName){
                jQuery.ajax({
                    type:'POST',
                    url: 'test.php',
                    dataType:'json',
                    data: {'weather':weatherName},
                    success: function( msg ) {
                        $( '#result' ).html(msg[0]);
                        weatherControl(msg);
                    }
                });
            }

    //            ajaxで得たデータを用いて画像のサイズを調整
            function weatherControl(msg) {
                let weatherSum = 0;
                let weather = [];
                let tmp = [];
                msg[0] = Number(msg[0]);
                msg[1] = Number(msg[1]);
                msg[2] = Number(msg[2]);
                weatherSum = msg[0]+msg[1]+msg[2];
                weather[0] = (msg[0]/weatherSum).toFixed(2)*100;//toFiexed(2)で少数第2位までで切っている
                weather[1] = (msg[1]/weatherSum).toFixed(2)*100;//*100でパーセント表現出来るようにしている
                weather[2] = (msg[2]/weatherSum).toFixed(2)*100;
                for(let i=0;i<3;i++){
                    if(weather[i] < 1){
                        weather[i]=1;
                    }
                    tmp[i]=weather[i];
                    weather[i]+="%";
                }
                $( '#sunny-count' ).html(msg[0]);
                $( '#cloudy-count' ).html(msg[1]);
                $( '#rain-count' ).html(msg[2]);
                $( '#weather-sunny' ).css('width',weather[0]);
                $( '#weather-cloudy' ).css('width',weather[1]);
                $( '#weather-rain' ).css('width',weather[2]);
            }


            //ここからは三角ボタンを使用したページ切り替え用
    //            downだったら
            $('#caret-down').click(function(){
                if(nowTime()) {
                    $('.weather').slideToggle(1000);
                    $('.music').slideToggle(1000);
                    $('header h1').text('music page');
                    $('header h5').slideToggle(1000);
                    $('header p').text('音楽を聴いて気分を変えてみてはいかがですか ♪');
                    $('#caret-down').slideToggle(1000);
                    $('#caret-up').slideToggle(1000);
                } else {
                    $('#caret-down').slideToggle(1000);
                }
            });
    //            upだったら
            $('#caret-up').click(function(){
                $('.weather').slideToggle(1000);
                $('.music').slideToggle(1000);
                $('header h1').text('今のお天気なあに？');
                $('header h5').slideToggle(1000);
                $('header p').text('今の天気の絵をクリックしてね ♪');
                $('#caret-up').slideToggle(1000);
                if(nowTime()) {
                    $('#caret-down').slideToggle(1000);
                }
            });
    //        今の時刻を取得し、3つの条件に合っているかチェック。
            function nowTime(){
                var now = new Date(); //インスタンス生成し、今の情報を得る
                var h = now.getHours(); //時を取得
                var mi = now.getMinutes(); //分を取得
                //            決めた時間内ならture、異なるならfalseを返す
                if(h == 0 && mi >= 0 && mi < 16) {
                    return true;
                } else if(h == 6 && mi >= 0 && mi< 5) {
                    return true;
                } else if(h == 12 && mi >= 0 && mi< 5) {
                    return true;
                } else if(h == 18 && mi >= 0 && mi< 5) {
                    return true;
                } else {
                    return false;
                }
            }

        //時間帯によって画像を変える
        function changeImg(){
            const d = new Date();
            const hour = d.getHours();

            if(hour >= 5 && hour < 19){
                $('#weather-sunny').html('<img src="img/weather0-sunny.png" alt="晴れの太陽">');
                console.log('晴れの太陽');
            } else {
                $('#weather-sunny').html('<img src="img/weather0-sunny-star.png" alt="晴れの星">');
                console.log('晴れの星');
            }
        }

        //時間帯と天気によって背景色を変える
        function changeImg(){
            const d = new Date();
//            const hour = d.getHours();
            const hour = 21;

            if(hour >= 3 && hour < 5){
                $('body').css('background-color','slategray');
                $('.card').css('background-color','slategray');
            } else if(hour >= 5 && hour < 8){
                $('body').css('background-color','lemonchiffon');
                $('.card').css('background-color','lemonchiffon');
                console.log('朝焼け');
            } else if(hour >= 8 && hour < 16){
                $('body').css('background-color','aliceblue');
                $('.card').css('background-color','aliceblue');
            } else if(hour >= 16 && hour < 19){
                $('body').css('background-color','navajowhite');
                $('.card').css('background-color','navajowhite');
            } else if(hour >= 19 && hour < 21){
                $('body').css('background-color','lightgray');
                $('.card').css('background-color','lightgray');
            } else {
                $('body').css('background-color','black');
                $('.card').css('background-color','black');
                $('body').css('color','white');
                $('.card').css('color','white');
                $('button').css('color','white');
            }
        }
        function weatherJudje(){

        }

        </script>

                        <!--        オリジナルのjsとjQueryを使ったコード-->

<!--
        <script type="text/javascript">
            $('#weather-sunny').click(function(){
                $.ajax({
                    type:'POST',
                    url:'./test.php',
                    dataType:'json',
                    data:{},
                    success: function(msg) {
                            document.getElementById("result").innerHTML=msg['name'];
                    }
                });
            });
        </script>
-->

<!--
        <script type="text/javascript">
            $(function(){
                $('#weather-sunny').on('click',function(){
                    $.ajax({
                        url:'./test.php',
                        type:'POST',
                        dataType:'json',
                        data:{}
                    })
                        .done( (data) => {
                        $('#result').html(data['name']);
                        console.log(data);
                    })
                        .fail( (data) => {
                        $('.result').html('ng');
                        console.log('ng');
                    })
                        .always( (data) => {

                    });
                });
            });
        </script>
-->


    </body>
</html>
